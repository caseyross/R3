script.
	import Account from '../account/Account.pug'
	import Comments from '../comment/Comments.pug'
	import Content from '../content/Content.pug'
	import Feed from './Feed.pug'
	import Placard from '../user/Placard.pug'
	import SubredditFilters from '../subreddit/SubredditFilters.pug'
	import Channel from './Channel.coffee'
	import Post from '../post/Post.coffee'
	export channel = new Channel('')
	selectedItem = null
	selectItem = (item) -> selectedItem = item
	columnWidths = [
		innerWidth / 12
		innerWidth / 12 * 3 - 48 - 1
		innerWidth / 12 * 4 + 96 + 2
		innerWidth / 12 * 4 - 48 - 1
	]
	

svelte:head
	title [{channel.name}]
.channel(style='grid-template-columns: {columnWidths.map(w => w + "px").join(" ")}')
	nav
		a(href='/')
			h1 Home
		a(href='/r/all')
			h1 All
		a(href='/r/popular')
			h1 Popular
		hr
		{#if LS.userKey}
			h2 Subscriptions
			{#if LS.userSubreddits}
				h3 Subreddits
				ol
					{#each LS.userSubreddits.split(',') as name}
						li
							a(href='/r/{name}') {name}
			{#if LS.userUsers}
				h3 Users
				ol
					{#each LS.userUsers.split(',') as name}
						li
							a(href='/u/{name}') {name}
		{:else}
			h2 Trending Subreddits
				ol
					{#each LS.popularSubreddits.split(',') as name}
						li
							a(href='/r/{name}') {name}

		Account
	menu#feed-actions
		{#if channel.type === 'subreddit'}
			SubredditFilters(subredditName={channel.name} sort={channel.sort})
	section.hide-scroll#feed
		{#await channel.getItems(10) then items}
			Feed(items={items} selectedItem={selectedItem} selectItem={selectItem} showFlair={channel.type === 'subreddit'})
	section.hide-scroll#content
		{#if selectedItem instanceof Post}
			h1 {selectedItem.title}
			Placard(score={selectedItem.score} name={selectedItem.authorName} flair={selectedItem.authorFlair} subredditName={selectedItem.subredditName} role={selectedItem.authorRole})
			Content(content={selectedItem.content})
	menu#comments-actions
	section.hide-scroll#comments
		{#if selectedItem instanceof Post}
			{#await selectedItem.comments then comments}
				Comments(comments={comments})

style.
	.channel
		height 100vh
		width 100vw
		display grid
		grid-template-rows 40px 1fr
		grid-auto-flow column
	nav
		grid-row 1 / span 2
		border-right 1px solid
	section
		overflow auto
	#feed
	#feed-actions
		padding 0 4em
		border-bottom 1px dotted
	#content
		grid-row 1 / span 2
	#comments
	#comments-actions
		padding 0 4em
		border-bottom 1px dotted