script.
	import { createEventDispatcher } from 'svelte'
	
	import api from '../../../api/index.js'

	import Button from '../shared/Button.pug'
	import Label from '../shared/Label.pug'
	import UserByline from '../user/UserByline.pug'

	export error = null
	export initial_text = ''
	export sending = false

	dispatch = createEventDispatcher()
	submit = ->
		text = textbox.innerText
		if text.length > 10000
			error = { message: 'max length is 10,000 chars' }
		if !error
			dispatch('submit', text)
	textbox = null

form.comment-editor
	UserByline(name={api.getUser()})
	<!-- svelte-ignore a11y-autofocus -->
	.comment-editor-text-field(aria-multiline={true} autofocus bind:this={textbox} contenteditable role='textbox') {initial_text}
	menu.comment-editor-actions
		Label(text={error ? 'Error: ' + (error.reason || error.message) : ''})
			Button(action={() => submit()} loading={sending} loading_text='Sending...' text='Submit')

style.
	.comment-editor-actions
		display flex
		justify-content flex-end
		margin-top 6px
	.comment-editor-text-field
		border 1px solid var(--c-score-0)
		border-radius 1em
		font 13px monospace
		line-height inherit
		padding 1em
		resize none
		white-space pre-line