script.
	import PageUnavailable from '../../infra/PageUnavailable.pug'
	import CommentList from '../listing/CommentList.pug'
	import PostList from '../listing/PostList.pug'
	import api from '../../../api/index.js'
	export items_filter = null
	export items_sort = null
	export user_name = null
	error = null
	info = null
	commentIds = null
	postIds = null
	api.watch(api.ID.dataset('user', user_name), (x) -> { data: info, error: error } = x)
	switch items_filter
		when 'comments'
			api.watch(api.ID.dataset('user_comments', user_name, items_sort, 10), (x) -> { data: commentIds } = x)
		else
			api.watch(api.ID.dataset('user_posts', user_name, items_sort, 10), (x) -> { data: postIds } = x)

svelte:head
	title user: {user_name}: {items_filter}
{#if error}
	{#if error instanceof api.errors.ConnectionFailedError || error instanceof api.errors.InvalidRequestError}
		PageUnavailable(path='/u/{user_name}')
{:else if postIds}
	PostList(ids={postIds})
{:else if commentIds}
	CommentList(ids={commentIds})