script.
	import api from '../../../api/index.js'
	import { relativize_url } from '../../app/routing/url.coffee'
	import FeedAvatar from '../feed/FeedAvatar.pug'
	
	export subreddit_name = null

	subreddit_custom_menu = null
	api.loadWatch(api.ID('subreddit_widgets', subreddit_name), (x) ->
		{ data: widgets } = x
		subreddit_custom_menu = widgets?.topbar?[0]?.data
	)

nav.subreddit-navigation
	FeedAvatar(type='subreddit' subreddit_name={subreddit_name})
	{#if subreddit_custom_menu}
		{#each subreddit_custom_menu as item}
			{#if item.children}
				details.subreddit-navigation-custom-menu-item
					summary {item.text}
					ol.subreddit-navigation-custom-menu-dropdown
						{#each item.children as child}
							a(href={relativize_url(child.url)}) {child.text}
			{:else}
				a.subreddit-navigation-custom-menu-item(href={relativize_url(item.url)}) {item.text}

style.
	.subreddit-navigation
		box-sizing content-box
		display flex
		gap 2em
		width 64px
		writing-mode vertical-rl
	.subreddit-navigation-custom-menu-dropdown
		display flex
		flex-flow column nowrap
		gap 0.25em
		padding 0 1em
		text-align right
		writing-mode initial
	.subreddit-navigation-custom-menu-item
		padding-right 34px
		white-space pre